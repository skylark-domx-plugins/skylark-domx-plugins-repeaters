{"version":3,"sources":["repeater-thumbnail.js"],"names":["define","langx","browser","eventer","noder","geom","$","fillTemplate","itemData","template","replace","end","start","val","indexOf","trim","substring","undefined","invalid","search","fn","repeater","Constructor","prototype","thumbnail_clearSelectedItems","this","$canvas","find","removeClass","thumbnail_getSelectedItems","selected","each","push","thumbnail_setSelectedItems","items","force","compareItemIndex","n","i","index","$item","compareItemSelector","is","selector","selectItem","$itm","select","selectable","self","addClass","l","viewOptions","thumbnail_selectable","isArray","length","defaults","mixin","thumbnail_alignment","thumbnail_infiniteScroll","thumbnail_itemRendered","thumbnail_noItemsHTML","thumbnail_template","viewTypes","thumbnail","opts","infScroll","infiniteScrolling","before","helpers","$empty","validAlignments","alignment","$cont","data","response","center","justify","left","right","thumbnail_injectSpacers","item","action","append","remove","renderItem","$thumbnail","subset","on","isDisabled","hasClass","$element","trigger","container","after"],"mappings":"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","file":"../repeater-thumbnail.js","sourcesContent":["define([\r\n    \"skylark-utils/langx\",\r\n    \"skylark-utils/browser\",\r\n    \"skylark-utils/eventer\",\r\n    \"skylark-utils/noder\",\r\n    \"skylark-utils/geom\",\r\n    \"skylark-utils/query\",\r\n    \"./repeater\"\r\n], function(langx, browser, eventer, noder, geom, $) {\r\n\r\n    /*\r\n     * Fuel UX Checkbox\r\n     * https://github.com/ExactTarget/fuelux\r\n     *\r\n     * Copyright (c) 2014 ExactTarget\r\n     * Licensed under the BSD New license.\r\n     */\r\n\r\n    if ($.fn.repeater) {\r\n        //ADDITIONAL METHODS\r\n        $.fn.repeater.Constructor.prototype.thumbnail_clearSelectedItems = function() {\r\n            this.$canvas.find('.repeater-thumbnail-cont .selectable.selected').removeClass('selected');\r\n        };\r\n\r\n        $.fn.repeater.Constructor.prototype.thumbnail_getSelectedItems = function() {\r\n            var selected = [];\r\n            this.$canvas.find('.repeater-thumbnail-cont .selectable.selected').each(function() {\r\n                selected.push($(this));\r\n            });\r\n            return selected;\r\n        };\r\n\r\n        $.fn.repeater.Constructor.prototype.thumbnail_setSelectedItems = function(items, force) {\r\n            var selectable = this.viewOptions.thumbnail_selectable;\r\n            var self = this;\r\n            var i, $item, l, n;\r\n\r\n            //this function is necessary because lint yells when a function is in a loop\r\n            function compareItemIndex() {\r\n                if (n === items[i].index) {\r\n                    $item = $(this);\r\n                    return false;\r\n                } else {\r\n                    n++;\r\n                }\r\n            }\r\n\r\n            //this function is necessary because lint yells when a function is in a loop\r\n            function compareItemSelector() {\r\n                $item = $(this);\r\n                if ($item.is(items[i].selector)) {\r\n                    selectItem($item, items[i].selected);\r\n                }\r\n            }\r\n\r\n            function selectItem($itm, select) {\r\n                select = (select !== undefined) ? select : true;\r\n                if (select) {\r\n                    if (!force && selectable !== 'multi') {\r\n                        self.thumbnail_clearSelectedItems();\r\n                    }\r\n\r\n                    $itm.addClass('selected');\r\n                } else {\r\n                    $itm.removeClass('selected');\r\n                }\r\n            }\r\n\r\n            if (!$.isArray(items)) {\r\n                items = [items];\r\n            }\r\n\r\n            if (force === true || selectable === 'multi') {\r\n                l = items.length;\r\n            } else if (selectable) {\r\n                l = (items.length > 0) ? 1 : 0;\r\n            } else {\r\n                l = 0;\r\n            }\r\n\r\n            for (i = 0; i < l; i++) {\r\n                if (items[i].index !== undefined) {\r\n                    $item = $();\r\n                    n = 0;\r\n                    this.$canvas.find('.repeater-thumbnail-cont .selectable').each(compareItemIndex);\r\n                    if ($item.length > 0) {\r\n                        selectItem($item, items[i].selected);\r\n                    }\r\n\r\n                } else if (items[i].selector) {\r\n                    this.$canvas.find('.repeater-thumbnail-cont .selectable').each(compareItemSelector);\r\n                }\r\n            }\r\n        };\r\n\r\n        //ADDITIONAL DEFAULT OPTIONS\r\n        $.fn.repeater.defaults = langx.mixin({}, $.fn.repeater.defaults, {\r\n            thumbnail_alignment: 'left',\r\n            thumbnail_infiniteScroll: false,\r\n            thumbnail_itemRendered: null,\r\n            thumbnail_noItemsHTML: 'no items found',\r\n            thumbnail_selectable: false,\r\n            thumbnail_template: '<div class=\"thumbnail repeater-thumbnail\"><img height=\"75\" src=\"{{src}}\" width=\"65\"><span>{{name}}</span></div>'\r\n        });\r\n\r\n        //EXTENSION DEFINITION\r\n        $.fn.repeater.viewTypes.thumbnail = {\r\n            selected: function() {\r\n                var infScroll = this.viewOptions.thumbnail_infiniteScroll;\r\n                var opts;\r\n                if (infScroll) {\r\n                    opts = (typeof infScroll === 'object') ? infScroll : {};\r\n                    this.infiniteScrolling(true, opts);\r\n                }\r\n            },\r\n            before: function(helpers) {\r\n                var alignment = this.viewOptions.thumbnail_alignment;\r\n                var $cont = this.$canvas.find('.repeater-thumbnail-cont');\r\n                var data = helpers.data;\r\n                var response = {};\r\n                var $empty, validAlignments;\r\n\r\n                if ($cont.length < 1) {\r\n                    $cont = $('<div class=\"clearfix repeater-thumbnail-cont\" data-container=\"true\" data-infinite=\"true\" data-preserve=\"shallow\"></div>');\r\n                    if (alignment && alignment !== 'none') {\r\n                        validAlignments = {\r\n                            'center': 1,\r\n                            'justify': 1,\r\n                            'left': 1,\r\n                            'right': 1\r\n                        };\r\n                        alignment = (validAlignments[alignment]) ? alignment : 'justify';\r\n                        $cont.addClass('align-' + alignment);\r\n                        this.thumbnail_injectSpacers = true;\r\n                    } else {\r\n                        this.thumbnail_injectSpacers = false;\r\n                    }\r\n                    response.item = $cont;\r\n                } else {\r\n                    response.action = 'none';\r\n                }\r\n\r\n                if (data.items && data.items.length < 1) {\r\n                    $empty = $('<div class=\"empty\"></div>');\r\n                    $empty.append(this.viewOptions.thumbnail_noItemsHTML);\r\n                    $cont.append($empty);\r\n                } else {\r\n                    $cont.find('.empty:first').remove();\r\n                }\r\n\r\n                return response;\r\n            },\r\n            renderItem: function(helpers) {\r\n                var selectable = this.viewOptions.thumbnail_selectable;\r\n                var selected = 'selected';\r\n                var self = this;\r\n                var $thumbnail = $(fillTemplate(helpers.subset[helpers.index], this.viewOptions.thumbnail_template));\r\n\r\n                $thumbnail.data('item_data', helpers.data.items[helpers.index]);\r\n\r\n                if (selectable) {\r\n                    $thumbnail.addClass('selectable');\r\n                    $thumbnail.on('click', function() {\r\n                        if (self.isDisabled) return;\r\n\r\n                        if (!$thumbnail.hasClass(selected)) {\r\n                            if (selectable !== 'multi') {\r\n                                self.$canvas.find('.repeater-thumbnail-cont .selectable.selected').each(function() {\r\n                                    var $itm = $(this);\r\n                                    $itm.removeClass(selected);\r\n                                    self.$element.trigger('deselected.fu.repeaterThumbnail', $itm);\r\n                                });\r\n                            }\r\n\r\n                            $thumbnail.addClass(selected);\r\n                            self.$element.trigger('selected.fu.repeaterThumbnail', $thumbnail);\r\n                        } else {\r\n                            $thumbnail.removeClass(selected);\r\n                            self.$element.trigger('deselected.fu.repeaterThumbnail', $thumbnail);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                helpers.container.append($thumbnail);\r\n                if (this.thumbnail_injectSpacers) {\r\n                    $thumbnail.after('<span class=\"spacer\">&nbsp;</span>');\r\n                }\r\n\r\n                if (this.viewOptions.thumbnail_itemRendered) {\r\n                    this.viewOptions.thumbnail_itemRendered({\r\n                        container: helpers.container,\r\n                        item: $thumbnail,\r\n                        itemData: helpers.subset[helpers.index]\r\n                    }, function() {});\r\n                }\r\n\r\n                return false;\r\n            }\r\n        };\r\n    }\r\n\r\n    //ADDITIONAL METHODS\r\n    function fillTemplate(itemData, template) {\r\n        var invalid = false;\r\n\r\n        function replace() {\r\n            var end, start, val;\r\n\r\n            start = template.indexOf('{{');\r\n            end = template.indexOf('}}', start + 2);\r\n\r\n            if (start > -1 && end > -1) {\r\n                val = langx.trim(template.substring(start + 2, end));\r\n                val = (itemData[val] !== undefined) ? itemData[val] : '';\r\n                template = template.substring(0, start) + val + template.substring(end + 2);\r\n            } else {\r\n                invalid = true;\r\n            }\r\n        }\r\n\r\n        while (!invalid && template.search('{{') >= 0) {\r\n            replace(template);\r\n        }\r\n\r\n        return template;\r\n    }\r\n\r\n});"]}