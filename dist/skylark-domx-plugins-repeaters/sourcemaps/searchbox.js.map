{"version":3,"sources":["SearchBox.js"],"names":["define","langx","browser","eventer","noder","geom","$","plugins","repeaters","SearchBox","Plugin","inherit","klassName","pluginName","options","clearOnEmpty","searchOnKeyPress","allowCancel","_construct","elm","this","overrided","$element","_elm","$repeater","closest","attr","$button","find","$input","$icon","on","proxy","buttonclicked","keypress","length","clearPending","activeSearch","_destroy","remove","each","val","outerHTML","search","searchText","hasClass","removeClass","addClass","trigger","clear","action","e","preventDefault","currentTarget","is","which","disable","enable","removeAttr","register"],"mappings":"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","file":"../SearchBox.js","sourcesContent":["define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins-base\",\r\n  \"./repeaters\"\r\n],function(langx,browser,eventer,noder,geom,$,plugins,repeaters){\r\n\r\n\r\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\r\n\r\n\tvar SearchBox = plugins.Plugin.inherit({\r\n\t\tklassName: \"SearchBox\",\r\n\r\n\t\tpluginName: \"lark.repeaters.searchbox\",\r\n\r\n\t\toptions : {\r\n\t\t\tclearOnEmpty: false,\r\n\t\t\tsearchOnKeyPress: false,\r\n\t\t\tallowCancel: false\r\n\t\t},\r\n\t\r\n    \t_construct : function(elm,options) {\r\n      \t\tthis.overrided(elm,options);\r\n      \t\t\r\n      \t\tthis.$element = $(this._elm);\r\n\t\t\tthis.$repeater = this.$element.closest('.repeater');\r\n\r\n\t\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\r\n\t\t\t\tthis.options.searchOnKeyPress = true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$button = this.$element.find('button');\r\n\t\t\tthis.$input = this.$element.find('input');\r\n\t\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\r\n\r\n\t\t\tthis.$button.on('click.lark.search', langx.proxy(this.buttonclicked, this));\r\n\t\t\tthis.$input.on('keyup.lark.search', langx.proxy(this.keypress, this));\r\n\r\n\t\t\tif (this.$repeater.length > 0) {\r\n\t\t\t\tthis.$repeater.on('rendered.lark.repeater', langx.proxy(this.clearPending, this));\r\n\t\t\t}\r\n\r\n\t\t\tthis.activeSearch = '';\r\n\t\t},\r\n\r\n\t\t_destroy: function () {\r\n\t\t\tthis.$element.remove();\r\n\t\t\t// any external bindings\r\n\t\t\t// [none]\r\n\t\t\t// set input value attrbute\r\n\t\t\tthis.$element.find('input').each(function () {\r\n\t\t\t\t$(this).attr('value', $(this).val());\r\n\t\t\t});\r\n\t\t\t// empty elements to return to original markup\r\n\t\t\t// [none]\r\n\t\t\t// returns string of markup\r\n\t\t\treturn this.$element[0].outerHTML;\r\n\t\t},\r\n\r\n\t\tsearch: function (searchText) {\r\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\r\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\r\n\t\t\t}\r\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\r\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\r\n\t\t\t}\r\n\r\n\t\t\tthis.activeSearch = searchText;\r\n\t\t\tthis.$element.addClass('searched pending');\r\n\t\t\tthis.$element.trigger('searched.lark.search', searchText);\r\n\t\t},\r\n\r\n\t\tclear: function () {\r\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\r\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\r\n\t\t\t}\r\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\r\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\r\n\t\t\t}\r\n\r\n\t\t\tif (this.$element.hasClass('pending')) {\r\n\t\t\t\tthis.$element.trigger('canceled.lark.search');\r\n\t\t\t}\r\n\r\n\t\t\tthis.activeSearch = '';\r\n\t\t\tthis.$input.val('');\r\n\t\t\tthis.$element.trigger('cleared.lark.search');\r\n\t\t\tthis.$element.removeClass('searched pending');\r\n\t\t},\r\n\r\n\t\tclearPending: function () {\r\n\t\t\tthis.$element.removeClass('pending');\r\n\t\t},\r\n\r\n\t\taction: function () {\r\n\t\t\tvar val = this.$input.val();\r\n\r\n\t\t\tif (val && val.length > 0) {\r\n\t\t\t\tthis.search(val);\r\n\t\t\t} else {\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbuttonclicked: function (e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\r\n\r\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\r\n\t\t\t\tthis.clear();\r\n\t\t\t} else {\r\n\t\t\t\tthis.action();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tkeypress: function (e) {\r\n\t\t\tvar ENTER_KEY_CODE = 13;\r\n\t\t\tvar TAB_KEY_CODE = 9;\r\n\t\t\tvar ESC_KEY_CODE = 27;\r\n\r\n\t\t\tif (e.which === ENTER_KEY_CODE) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.action();\r\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.clear();\r\n\t\t\t} else if (this.options.searchOnKeyPress) {\r\n\t\t\t\t// search on other keypress\r\n\t\t\t\tthis.action();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdisable: function () {\r\n\t\t\tthis.$element.addClass('disabled');\r\n\t\t\tthis.$input.attr('disabled', 'disabled');\r\n\r\n\t\t\tif (!this.options.allowCancel) {\r\n\t\t\t\tthis.$button.addClass('disabled');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tenable: function () {\r\n\t\t\tthis.$element.removeClass('disabled');\r\n\t\t\tthis.$input.removeAttr('disabled');\r\n\t\t\tthis.$button.removeClass('disabled');\r\n\t\t}\r\n\t});\r\n\r\n    plugins.register(SearchBox);\r\n\r\n\treturn \trepeaters.SearchBox = SearchBox;\r\n});\r\n"]}