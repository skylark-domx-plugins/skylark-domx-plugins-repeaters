{"version":3,"sources":["searchbox.js"],"names":["define","langx","browser","eventer","noder","geom","$","plugins","SearchBox","Plugin","inherit","klassName","pluginName","options","clearOnEmpty","searchOnKeyPress","allowCancel","_construct","elm","this","overrided","$element","_elm","$repeater","closest","attr","$button","find","$input","$icon","on","proxy","buttonclicked","keypress","length","clearPending","activeSearch","_destroy","remove","each","val","outerHTML","search","searchText","hasClass","removeClass","addClass","trigger","clear","action","e","preventDefault","currentTarget","is","which","disable","enable","removeAttr","register"],"mappings":"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","file":"../searchbox.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins-base\"\n],function(langx,browser,eventer,noder,geom,$,plugins){\n\n\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\n\n\tvar SearchBox = plugins.Plugin.inherit({\n\t\tklassName: \"SearchBox\",\n\n\t\tpluginName: \"lark.fuelux.searchbox\",\n\n\t\toptions : {\n\t\t\tclearOnEmpty: false,\n\t\t\tsearchOnKeyPress: false,\n\t\t\tallowCancel: false\n\t\t},\n\t\n    \t_construct : function(elm,options) {\n      \t\tthis.overrided(elm,options);\n      \t\t\n      \t\tthis.$element = $(this._elm);\n\t\t\tthis.$repeater = this.$element.closest('.repeater');\n\n\t\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\n\t\t\t\tthis.options.searchOnKeyPress = true;\n\t\t\t}\n\n\t\t\tthis.$button = this.$element.find('button');\n\t\t\tthis.$input = this.$element.find('input');\n\t\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\n\n\t\t\tthis.$button.on('click.lark.search', langx.proxy(this.buttonclicked, this));\n\t\t\tthis.$input.on('keyup.lark.search', langx.proxy(this.keypress, this));\n\n\t\t\tif (this.$repeater.length > 0) {\n\t\t\t\tthis.$repeater.on('rendered.lark.repeater', langx.proxy(this.clearPending, this));\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t},\n\n\t\t_destroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tsearch: function (searchText) {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\n\t\t\t}\n\n\t\t\tthis.activeSearch = searchText;\n\t\t\tthis.$element.addClass('searched pending');\n\t\t\tthis.$element.trigger('searched.lark.search', searchText);\n\t\t},\n\n\t\tclear: function () {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\n\t\t\t}\n\n\t\t\tif (this.$element.hasClass('pending')) {\n\t\t\t\tthis.$element.trigger('canceled.lark.search');\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t\tthis.$input.val('');\n\t\t\tthis.$element.trigger('cleared.lark.search');\n\t\t\tthis.$element.removeClass('searched pending');\n\t\t},\n\n\t\tclearPending: function () {\n\t\t\tthis.$element.removeClass('pending');\n\t\t},\n\n\t\taction: function () {\n\t\t\tvar val = this.$input.val();\n\n\t\t\tif (val && val.length > 0) {\n\t\t\t\tthis.search(val);\n\t\t\t} else {\n\t\t\t\tthis.clear();\n\t\t\t}\n\t\t},\n\n\t\tbuttonclicked: function (e) {\n\t\t\te.preventDefault();\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\n\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\n\t\t\t\tthis.clear();\n\t\t\t} else {\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER_KEY_CODE = 13;\n\t\t\tvar TAB_KEY_CODE = 9;\n\t\t\tvar ESC_KEY_CODE = 27;\n\n\t\t\tif (e.which === ENTER_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.action();\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clear();\n\t\t\t} else if (this.options.searchOnKeyPress) {\n\t\t\t\t// search on other keypress\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', 'disabled');\n\n\t\t\tif (!this.options.allowCancel) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t}\n\t});\n\n    plugins.register(SearchBox);\n\n\treturn \tSearchBox;\n});\n"]}